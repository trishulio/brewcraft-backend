pipeline {
    agent {
        label 'docker'
    }

    parameters {
        string(name: 'HOST_URL', defaultValue: '172.17.0.1')
    }

    stages {
        stage ('Checkout') {
            steps {
                checkout scm
            }
        }

        stage ('Generate Reports') {
            parallel {
                stage ('Generate Code Coverage') {
                    steps {
                        build job: '../Brewcraft Report Code Coverage', parameters: [
                            string(name: 'HOST_URL', value: params.HOST_URL),
                            string(name: 'JACOCO_SOURCE_HTML_DIR', value: 'target/site/jacoco'),
                            string(name: 'JACOCO_TARGET_HTML_DIR', value: '/home/mrishab/brewcraft/code/html/jacoco')
                        ]
                    }
                }

                stage ('Generate Mutation Coverage') {
                    steps {
                        build job: '../Brewcraft Report Mutation Coverage', parameters: [
                            string(name: 'HOST_URL', value: params.HOST_URL),
                            string(name: 'PITEST_SOURCE_HTML_DIR', value: 'target/pit-reports'),
                            string(name: 'PITEST_TARGET_HTML_DIR', value: '/home/mrishab/brewcraft/code/html/pit-reports')
                        ]
                    }
                }
            }
        }

    }
}